#pragma checksum "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "81fae6b5b6ce2fee829d00e81ede797c925610e9"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_ModuleAnnotations_Index), @"mvc.1.0.view", @"/Views/ModuleAnnotations/Index.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\_ViewImports.cshtml"
using Urfu.Its.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
using Urfu.Its.Web.Models;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"81fae6b5b6ce2fee829d00e81ede797c925610e9", @"/Views/ModuleAnnotations/Index.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"571aa92c4ca967469f2915635495580dde4274ca", @"/Views/_ViewImports.cshtml")]
    public class Views_ModuleAnnotations_Index : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 2 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
  
    ViewBag.Title = "Список аннотаций модулей";
    Layout = "~/Views/Shared/_ExtLayout.cshtml";

    var canManageWorkingPrograms = User.IsInRole(ItsRoles.WorkingProgramManager);
    var canViewWorkingPrograms = User.IsInRole(ItsRoles.WorkingProgramView);

#line default
#line hidden
#nullable disable
            WriteLiteral("<style>\r\n\r\n    .its-medium {\r\n        width: 24px;\r\n        height: 24px;\r\n        margin-left: 5px;\r\n    }\r\n</style>\r\n");
            DefineSection("scripts", async() => {
                WriteLiteral("\r\n    <script");
                BeginWriteAttribute("src", " src=\"", 448, "\"", 510, 1);
#nullable restore
#line 19 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
WriteAttributeValue("", 454, Url.Content("~/Scripts/VersionedDocs/versionedDocs.js"), 454, 56, false);

#line default
#line hidden
#nullable disable
                EndWriteAttribute();
                WriteLiteral(@"></script>

    <script type=""text/javascript"">
    var localStorageName = ""ModuleAnnotationsListFilter"";
    Ext.onReady(function() {
        Ext.tip.QuickTipManager.init();

        function required(value) {
            return (value != undefined && value.length > 0) ? true : ""Поле не может быть пустым"";
        }

        var dataDivisions = Urfu.parseJson('");
#nullable restore
#line 30 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                                       Write(ViewBag.Divisions);

#line default
#line hidden
#nullable disable
                WriteLiteral(@"');
        var divisionStore = Ext.create(""Ext.data.Store"",
            {
                data: dataDivisions
            });
        var directionStore = Ext.create(""Ext.data.Store"", {});
        var dataDirections = dataDivisions.map(d => d.Directions).reduce(function (a, b) { return a.concat(b); })
            .sort((a, b) => (a.DirectionName > b.DirectionName) ? 1 : ((b.DirectionName > a.DirectionName) ? -1 : 0));

        var profileStore = Ext.create(""Ext.data.Store"", {});
        var ohopStore = Ext.create(""Ext.data.Store"", {});
        var planStore = Ext.create(""Ext.data.Store"", {});

        var directionFiltersStore = Ext.create(""Ext.data.Store"", {});
        var profileFiltersStore = Ext.create(""Ext.data.Store"", {});

        var dataStatuses = Urfu.parseJson('");
#nullable restore
#line 46 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                                      Write(ViewBag.Statuses);

#line default
#line hidden
#nullable disable
                WriteLiteral(@"');
        var statusStore = Ext.create(""Ext.data.Store"",
            {
                data: dataStatuses
            });

        var store = Ext.create(""Ext.data.Store"",
            {
                autoLoad: false,
                remoteSort: false,
                remoteFilter: true,
                proxy: {
                    type: 'ajax',
                    url: window.location.href,
                    reader: {
                        type: 'json',
                        rootProperty: 'data',
                        totalProperty: 'total'
                    }
                }
            });

        var prevSettings = {};
        try {
            var prevSettingString = JSON.parse(localStorage.getItem(localStorageName) || ""[]"");

            for (var i = 0; i < prevSettingString.length; i++) {
                prevSettings[prevSettingString[i][""property""]] = prevSettingString[i][""value""];
            }
        } catch (err) {
        }
        var filtersWnd = n");
                WriteLiteral(@"ull;

        function loadStore() {
            store.proxy.setUrl(window.location.pathname +
                '?filter=' +
                encodeURIComponent(localStorage.getItem(localStorageName)));
            store.load();
        }

        var setFilters = function(ohopId) {
            var settings = [
                { property: 'divisionId', value: filtersWnd.getComponent(""division"").getValue() },
                { property: 'directionId', value: filtersWnd.getComponent(""direction"").getValue() },
                { property: 'profileId', value: filtersWnd.getComponent(""profile"").getValue() },
                { property: 'statusId', value: filtersWnd.getComponent(""status"").getValue() },
                { property: 'ohopId', value: ohopId }
            ];
            localStorage.setItem(localStorageName, JSON.stringify(settings));
            loadStore();
        };

        var changeDivisionEvent = function (wnd, directions, profiles, newValue, isFilter) {
            wnd.items.");
                WriteLiteral(@"items.find(p => p.itemId == ""direction"").setValue('');
            directions.setData([]);

            wnd.items.items.find(p => p.itemId == ""profile"").setValue('');
            profiles.setData([]);

            if (newValue != '' && newValue != null) {
                try {
                    var currentDivisionData = divisionStore.data.items.filter(d => d.data.DivisionId == newValue)[0].data;
                    directions.setData(currentDivisionData.Directions);
                }
                catch{ }
            }
            else {
                if (isFilter) {
                    directions.setData(dataDirections);
                }
            }
        }

        var changeDirectionEvent = function (wnd, directions, profiles, newValue) {
            wnd.items.items.find(p => p.itemId == ""profile"").setValue('');
            profiles.setData([]);

            if (newValue != '' && newValue != null) {
                try {
                    var currentDirectionData = d");
                WriteLiteral(@"irections.data.items.filter(d => d.data.DirectionId == newValue)[0].data;
                    profiles.setData(currentDirectionData.Profiles);
                }
                catch{ }
            }
        }

        filtersWnd = Ext.create('Ext.window.Window',
            {
                title: ""Фильтры"",
                closeAction: 'hide',
                resizable: false,
                autoHeight: false,
                bodyPadding: 6,
                defaults: {
                    xtype: 'textfield',
                    width: 500,
                    labelWidth: 130
                },
                items: [
                    {
                        fieldLabel: ""Институт"",
                        itemId: ""division"",
                        value: prevSettings['divisionId'],
                        xtype: ""combobox"",
                        store: divisionStore,
                        valueField: 'DivisionId',
                        displayField: 'DivisionName',
");
                WriteLiteral(@"                        queryMode: 'local',
                        anyMatch: true,
                        width: 500,
                        listeners: {
                            change: function (t, newValue, oldValue, eOpts) {
                                changeDivisionEvent(filtersWnd, directionFiltersStore, profileFiltersStore, newValue, true);
                            }
                        }
                    },
                    {
                        fieldLabel: ""Направление"",
                        itemId: ""direction"",
                        value: prevSettings['directionId'],
                        xtype: ""combobox"",
                        store: directionFiltersStore,
                        valueField: 'DirectionId',
                        displayField: 'DirectionName',
                        queryMode: 'local',
                        anyMatch: true,
                        width: 500,
                        listeners: {
                          ");
                WriteLiteral(@"  change: function (t, newValue, oldValue, eOpts) {
                                changeDirectionEvent(filtersWnd, directionFiltersStore, profileFiltersStore, newValue);
                            }
                        }
                    },
                    {
                        fieldLabel: ""Образовательная программа"",
                        itemId: ""profile"",
                        value: prevSettings['profileId'],
                        xtype: ""combobox"",
                        store: profileFiltersStore,
                        valueField: 'ProfileId',
                        displayField: 'ProfileName',
                        queryMode: 'local',
                        anyMatch: true,
                        width: 500
                    },
                    {
                        fieldLabel: ""Статус"",
                        itemId: ""status"",
                        value: prevSettings['statusId'],
                        xtype: ""combobox"",
              ");
                WriteLiteral(@"          store: statusStore,
                        valueField: 'Id',
                        displayField: 'Name',
                        queryMode: 'local',
                        anyMatch: true,
                        width: 300
                    }
                ],
                buttons: [
                    {
                        text: ""OK"",
                        handler: function () {
                            setFilters();
                            filtersWnd.hide();
                        }
                    },
                    {
                        text: ""Отмена"",
                        handler: function () { filtersWnd.hide(); }
                    }
                ]
            });

        changeDivisionEvent(filtersWnd, directionFiltersStore, profileFiltersStore, prevSettings['divisionId'], true);
        changeDirectionEvent(filtersWnd, directionFiltersStore, profileFiltersStore, prevSettings['directionId']);
        filtersWnd.getComponen");
                WriteLiteral(@"t(""direction"").setValue(prevSettings['directionId']);
        filtersWnd.getComponent(""profile"").setValue(prevSettings['profileId']);

        setFilters(prevSettings['ohopId']);

        var createWnd = Ext.create('Ext.window.Window',
        {
            title: ""Добавление аннотации модулей"",
            closeAction: 'hide',
            resizable: false,
            autoHeight: false,
            bodyPadding: 6,
            defaults: {
                xtype: 'textfield',
                width: 500,
                labelWidth: 130
            },
            items: [
                {
                    fieldLabel: ""Институт"",
                    itemId: ""division"",
                    xtype: ""combobox"",
                    store: divisionStore,
                    valueField: 'DivisionId',
                    displayField: 'DivisionName',
                    queryMode: 'local',
                    anyMatch: true,
                    allowBlank: true,
                    width: 5");
                WriteLiteral(@"00,
                    listeners: {
                        change: function (t, newValue, oldValue, eOpts) {
                            changeDivisionEvent(createWnd, directionStore, profileStore, newValue, false);
                        }
                    }
                },
                {
                    fieldLabel: ""Направление"",
                    itemId: ""direction"",
                    xtype: ""combobox"",
                    store: directionStore,
                    valueField: 'DirectionId',
                    displayField: 'DirectionName',
                    queryMode: 'local',
                    anyMatch: true,
                    allowBlank: false,
                    width: 500,
                    listeners: {
                        change: function (t, newValue, oldValue, eOpts) {
                            changeDirectionEvent(createWnd, directionStore, profileStore, newValue);
                        }
                    }
                },
       ");
                WriteLiteral(@"         {
                    fieldLabel: ""Образовательная программа"",
                    itemId: ""profile"",
                    xtype: ""combobox"",
                    store: profileStore,
                    valueField: 'ProfileId',
                    displayField: 'ProfileName',
                    queryMode: 'local',
                    anyMatch: true,
                    allowBlank: false,
                    width: 500,
                    listeners: {
                        change: function (t, newValue, oldValue, eOpts) {
                            createWnd.items.items.find(p => p.itemId == ""ohop"").setValue('');
                            ohopStore.setData([]);
                            planStore.setData([]);

                            if (newValue != '' && newValue != null) {
                                try {
                                    var currentProfileData = profileStore.data.items.filter(d => d.data.ProfileId == newValue)[0].data;
                        ");
                WriteLiteral(@"            ohopStore.setData(currentProfileData.Ohops);
                                    planStore.setData(currentProfileData.Plans);
                                }
                                catch{ }
                            }
                        }
                    }
                },
                {
                    fieldLabel: ""Учебный год и версия ОХОП"",
                    itemId: ""ohop"",
                    xtype: ""combobox"",
                    store: ohopStore,
                    valueField: 'OhopId',
                    displayField: 'VersionYear',
                    queryMode: 'local',
                    anyMatch: true,
                    allowBlank: false,
                    width: 300
                },
                {
                    fieldLabel: ""Учебный план и версия"",
                    itemId: ""plan"",
                    xtype: ""combobox"",
                    store: planStore,
                    valueField: 'NumberAndVersion',
");
                WriteLiteral(@"                    displayField: 'NumberAndVersion',
                    queryMode: 'local',
                    anyMatch: true,
                    allowBlank: false,
                    width: 300
                }
            ],
            buttons: [
                {
                    text: ""OK"",
                    handler: function () {
                        var isValid = true;
                        createWnd.items.items.forEach(function (element, index, array) {
                            if (!element.isValid()) isValid = false;
                        });
                        if (!isValid) return false;
                        
                        var planData = planStore.data.items.filter(d => d.data.NumberAndVersion == createWnd.getComponent(""plan"").getValue())[0].data;

                        //var maskEl = this.up('window').getEl();
                        //maskEl.mask('Выполнение операции...');
                        Ext.Ajax.request({
                    ");
                WriteLiteral(@"        url: '/ModuleAnnotations/CreateOrEdit',
                            params: {
                                ohopId: createWnd.getComponent(""ohop"").getValue(),
                                planNumber: planData.PlanNumber,
                                planVersionNumber: planData.PlanVersionNumber
                            },
                            success: function (response) {
                                var resp = Ext.JSON.decode(response.responseText);
                                if (resp.create) {
                                    Ext.Ajax.request({
                                        url: '/WorkingPrograms/CreateNew' + window.location.search,
                                        success: function (response) {
                                            var d = Ext.JSON.decode(response.responseText);
                                            window.location.assign(d.redirect);
                                            maskEl.unmask();
              ");
                WriteLiteral(@"                          },
                                        failure: function (d) {
                                            console.error(d.responseText);
                                            maskEl.unmask();
                                            alert(d.responseText);
                                        },
                                        jsonData: {
                                            linkedEntityId: createWnd.getComponent(""ohop"").getValue(),
                                            documentKind: ");
#nullable restore
#line 364 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                                                     Write(ViewBag.DocumentKind);

#line default
#line hidden
#nullable disable
                WriteLiteral(@",
                                            standard: resp.standard,
                                            planNumber: planData.PlanNumber,
                                            planVersionNumber: planData.PlanVersionNumber
                                        }
                                    });
                                }
                                else {
                                    window.location.assign('/Document/' + resp.documentId);
                                }
                                //maskEl.unmask();
                            },
                            failure: function (d) {
                                console.error(d.responseText);
                                //maskEl.unmask();
                                alert(d.responseText);
                            }
                        });
                    }
                },
                {
                    text: ""Отмена"",
                    handler");
                WriteLiteral(@": function () { createWnd.close(); }
                }
            ]
        });

        var updateStatusWnd = function (record) {
            return Ext.create('Ext.window.Window',
                {
                    title: ""Редактирование статуса Аннотации модулей"",
                    closeAction: 'hide',
                    overflowY: 'auto',
                    resizable: true,
                    maxHeight: 500,
                    autoHeight: true,
                    maxWidth: 400,
                    modal: true,
                    bodyPadding: 6,
                    layout: { type: 'vbox', align: 'stretch' },
                    items: [
                        {
                            xtype: 'hidden',
                            hidden: true,
                            value: record.data.versionedDocumentId,
                            itemId: ""versionedDocumentId""
                        },
                        {
                            xtype: 'label',
 ");
                WriteLiteral(@"                           text: `${record.data.profile} ${record.data.profileTitle}`,
                            style: 'font-weight: normal;'
                        },
                        {
                            xtype: 'label',
                            text: `Версия ОХОП ${record.data.basicCharacteristicOPVersion}`,
                            style: 'font-weight: normal;'
                            //style: 'font-weight: bold;'
                        },
                        {
                            fieldLabel: ""Статус"",
                            itemId: ""StatusId"",
                            //margin: '10 0 0 0',
                            value: record.data.statusId,
                            xtype: ""combobox"",
                            store: statusStore,
                            valueField: 'Id',
                            displayField: 'Name',
                            queryMode: 'local',
                            anyMatch: true,
            ");
                WriteLiteral(@"                width: 300,
                            labelWidth: 50
                        },
                        {
                            xtype: 'label',
                            text: `Комментарий`,
                            style: 'font-weight: normal;'
                            //style: 'font-weight: bold;'
                        },
                        {
                            xtype: 'textarea',
                            fieldLabel: '',
                            itemId: 'Comment',
                            value: record.data.comment,
                            width: 400,
                            height: 100
                        }
                    ],
                    buttons: [
                        {
                            text: ""Сохранить"",
                            handler: function (btn) {

                                var statusId = btn.up().up().items.items.find(c => c.itemId == ""StatusId"").getValue();
             ");
                WriteLiteral(@"                   var id = btn.up().up().items.items.find(c => c.itemId == ""versionedDocumentId"").getValue();
                                var comment = btn.up().up().items.items.find(c => c.itemId == ""Comment"").getValue();

                                Ext.getBody().mask('Сохранение статуса...');
                                Ext.Ajax.request({
                                    url: '/ModuleAnnotations/UpdateVersionStatus',
                                    params: {
                                        id: id,
                                        status: statusId,
                                        comment: comment
                                    },
                                    timeout: 120000,
                                    success: function (response) {
                                        var data = Ext.decode(response.responseText);
                                        if (!data.success) {
                                            Ext.Messag");
                WriteLiteral(@"eBox.show({
                                                title: 'Информационное сообщение',
                                                msg: data.message,
                                                buttons: Ext.MessageBox.OK,
                                                fn: function (btn) {
                                                }
                                            });
                                        }
                                        else
                                            store.reload();
                                        Ext.getBody().unmask();
                                    },
                                    failure: function (d) {
                                        Ext.MessageBox.alert('Ошибка', ""Неизвестная ошибка"");
                                        Ext.getBody().unmask();
                                    }
                                });

                                btn.up('window').close();");
                WriteLiteral(@"
                            }
                        }
                    ]
                });
        }

        var id = 'moduleAnnotationsGrid';

        var gridPanel = Ext.create('Ext.grid.Panel', {
            region: 'center',
            store: store,
            id: id,
            tbar: [
                {
                    xtype: 'button',
                    text: 'Фильтры...',
                    handler: function() { filtersWnd.show(); }
                },
                {
                    xtype: 'button',
                    text: ""Отменить фильтры"",
                    handler: function() {
                        localStorage.setItem(localStorageName, ""[]"");
                        loadStore();
                    }
                }, '-',
                {
                    xtype: 'button',
                    text: 'Добавить',
                    hidden: '");
#nullable restore
#line 520 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                        Write(ViewBag.CanEdit);

#line default
#line hidden
#nullable disable
                WriteLiteral(@"' == 'False',
                    handler: function () {
                        createWnd.show();
                    }
                }
            ],
            loadMask: true,
            columnLines: true,
            viewConfig: {
                markDirty: false
            },
            columns: [
                { xtype: 'rownumberer', width: 50 },
                {
                    header: 'Направление',
                    dataIndex: 'directionOkso',
                    width: 200,
                    renderer: function (value, metaData, record, rowIndex, colIndex, store, view) {
                        value = `${record.data.directionOkso} - ${record.data.directionTitle}`;
                        metaData.tdAttr = 'data-qtip=""' + Ext.String.htmlEncode(value) + '""';
                        return value;
                    }
                },
                {
                    header: 'Стандарт',
                    dataIndex: 'standard',
                    rend");
                WriteLiteral(@"erer: Ext.util.Format.htmlEncode,
                    width: 130
                },
                {
                    header: 'Образовательная программа',
                    dataIndex: 'profile',
                    width: 200,
                    renderer: function (value, metaData, record, rowIndex, colIndex, store, view) {
                        value = `${record.data.profile} - ${record.data.profileTitle}`;
                        metaData.tdAttr = 'data-qtip=""' + Ext.String.htmlEncode(value) + '""';
                        return value;
                    }
                },
                {
                    header: 'Уровень обучения',
                    align: 'center',
                    dataIndex: 'qualification',
                    width: 150
                },
                {
                    header: 'Подразделение',
                    dataIndex: 'chairTitle',
                    cellWrap: true,
                    renderer: Ext.util.Format.htmlEncode,
   ");
                WriteLiteral(@"                 width: 180
                },
                {
                    header: 'Год',
                    dataIndex: 'year',
                    renderer: Ext.util.Format.htmlEncode,
                    width: 80
                },
                {
                    header: 'Учебный план',
                    dataIndex: 'planNumber',
                    width: 100,
                    renderer: function (value, metaData, record, rowIndex, colIndex, store, view) {
                        value = `${record.data.planNumber} (${record.data.planVersionNumber})`;
                        metaData.tdAttr = 'data-qtip=""' + Ext.String.htmlEncode(value) + '""';
                        return value;
                    }
                },
                {
                    header: 'Статус',
                    align: 'center',
                    dataIndex: 'status',
                    width: 150,
                    renderer: Ext.util.Format.htmlEncode
                },
   ");
                WriteLiteral(@"             {
                    header: 'Дата изменения статуса',
                    align: 'center',
                    dataIndex: 'statusChangeTime',
                    width: 150
                },
                {
                    xtype: 'actioncolumn',
                    region: 'center',
                    width: 80,
                    items: [
                        {
                            icon: '");
#nullable restore
#line 607 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                              Write(Url.Content("~/Content/Images/comment2.png"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"',
                            iconCls: 'icon-toppadding',
                            tooltip: 'Комменатрий',
                            handler: function (grid, rowIndex, colIndex) {
                                var rec = grid.getStore().getAt(rowIndex);
                                Ext.Msg.show({
                                    title: 'Комментарий',
                                    message: rec.data.comment,
                                    width: 500,
                                    height: 300
                                })
                                grid.getSelectionModel().select(rec);
                            }
                        },
                        {
                            icon: '");
#nullable restore
#line 622 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                              Write(Url.Content("~/Content/Images/send.png?30"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"',
                            iconCls: 'icon-padding-mediumicon',
                            tooltip: 'Отправить на согласование',
                            handler: function (grid, rowIndex, colIndex) {
                                var rec = grid.getStore().getAt(rowIndex);
                                if (rec.data.statusId === 10 || rec.data.statusId === 11) {
                                    Ext.MessageBox.show({
                                        title: 'Информационное сообщение',
                                        msg: ""Документ уже находится в обработке или подписан"",
                                        buttons: Ext.MessageBox.OK
                                    });

                                    return;
                                }

                                Ext.getBody().mask('Отправка...');
                                Ext.Ajax.request({
                                    url: '/ModuleAnnotations/SendVersion',
                      ");
                WriteLiteral(@"              params: {
                                        id: rec.get('versionedDocumentId')
                                    },
                                    timeout: 120000,
                                    success: function (response) {
                                        var d = Ext.JSON.decode(response.responseText);

                                        if (!d.success) {
                                            Ext.MessageBox.show({
                                                title: 'Ошибка',
                                                msg: d.message,
                                                buttons: Ext.MessageBox.OK
                                            });
                                        } else {
                                            try {
                                                grid.getStore().getAt(rowIndex).data.status = d.status;
                                                grid.getStore().getAt(rowIndex).da");
                WriteLiteral(@"ta.statusId = d.statusId;
                                                grid.getStore().getAt(rowIndex).data.statusChangeTime = d.statusDate;

                                                Ext.getCmp(id).getView().scrollRowIntoView(rowIndex)

                                                Ext.getCmp(id).getView().focusRow(grid.getStore().getAt(rowIndex));
                                                Ext.getCmp(id).getSelectionModel().select(grid.getStore().getAt(rowIndex));

                                                Ext.getCmp(id).getView().refresh();


                                                Ext.MessageBox.show({
                                                    title: 'Уведомление',
                                                    msg: 'Документ отправлен на согласование',
                                                    buttons: Ext.MessageBox.OK
                                                });
                                            }
                 ");
                WriteLiteral(@"                           catch{

                                            }
                                        }

                                        Ext.getBody().unmask();
                                    },
                                    failure: function (d) {
                                        Ext.MessageBox.show({
                                            title: 'Ошибка',
                                            msg: 'Неизвестная ошибка',
                                            buttons: Ext.MessageBox.OK
                                        });
                                        Ext.getBody().unmask();
                                    }
                                });
                            }
                        },
                    ]
                },
                {
                    xtype: 'templatecolumn',
                    sortable: false,
                    tpl: new Ext.XTemplate(`<a href='/Document/{versi");
                WriteLiteral(@"onedDocumentId}'>АМ</a>`),
                    width: 60
                },
                {
                    xtype: 'actioncolumn',

                    region: 'center',
                    width: 130,
                    defaults: {
                        metadata: {
                            attr: 'style=""padding-left:10px;width:auto;""'
                        }
                    },
                    items: [
                        {
                            icon: '");
#nullable restore
#line 711 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                              Write(Url.Content("~/Content/Images/edit.png"));

#line default
#line hidden
#nullable disable
                WriteLiteral("\',\r\n                            iconCls: \'");
#nullable restore
#line 712 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                                 Write(ViewBag.CanApprove);

#line default
#line hidden
#nullable disable
                WriteLiteral(@"' == 'True' ? 'icon-padding' : '{ visibility: hidden }',
                            tooltip: 'Изменить статус',
                            handler: function(grid, rowIndex, colIndex) {
                                var rec = grid.getStore().getAt(rowIndex);
                                var wnd = updateStatusWnd(rec);
                                wnd.show();
                            }
                        },
                        {
                            icon: '");
#nullable restore
#line 721 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                              Write(Url.Content("~/Content/Images/doc1.png?22"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"',
                            iconCls: 'icon-padding',
                            text: 'Скачать docx',
                            tooltip: 'Скачать docx',
                            handler: function(grid, rowIndex, colIndex) {
                                var rec = grid.getStore().getAt(rowIndex);
                                window.location = '/Document/' + rec.get('versionedDocumentId') + '/Print?format=docx';
                            }
                        },
                        {
                            icon: '");
#nullable restore
#line 731 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                              Write(Url.Content("~/Content/Images/remove2.png"));

#line default
#line hidden
#nullable disable
                WriteLiteral("\',\r\n                            iconCls: \'");
#nullable restore
#line 732 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                                 Write(ViewBag.CanEdit);

#line default
#line hidden
#nullable disable
                WriteLiteral(@"' == 'True' ? 'icon-padding-squareicon' : '{ visibility: hidden }',
                            text: 'Удалить',
                            tooltip: 'Удалить',
                            handler: function(grid, rowIndex, colIndex) {

                                var rec = grid.getStore().getAt(rowIndex);
                                var maskEl = grid.getEl();
                                function request(confirmed) {
                                    maskEl.mask('Выполнение операции...');

                                    Ext.Ajax.request({
                                        url: '/ModuleAnnotations/Remove',
                                        params: {
                                            id: rec.get('versionedDocumentId')
                                        },
                                        success: function (response) {
                                            store.reload();
                                            maskEl.unmask();
     ");
                WriteLiteral(@"                                   },
                                        failure: function (d) {
                                            maskEl.unmask();

                                            console.error(d.responseText);
                                            alert(d.responseText);
                                        }
                                    });
                                }

                                Ext.MessageBox.show({
                                    title: 'Информационное сообщение',
                                    msg: ""Вы действительно хотите удалить аннотацию модулей?"",
                                    buttons: Ext.MessageBox.YESNO,
                                    fn: function (btn) {
                                        if (btn === 'yes') {
                                            request();
                                        }
                                    }
                                });
     ");
                WriteLiteral("                       }\r\n                        },\r\n                        {\r\n                            icon: \'");
#nullable restore
#line 773 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                              Write(Url.Content("~/Content/Images/arrow.png"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"',
                            iconCls: 'icon-padding-mediumicon',
                            tooltip: 'Версия ОХОП',
                            handler: function(grid, rowIndex, colIndex) {
                                var rec = grid.getStore().getAt(rowIndex);
                                var settings = [
                                    { property: 'divisionId', value: '' },
                                    { property: 'directionId', value: '' },
                                    { property: 'profileId', value: '' },
                                    { property: 'statusId', value: '' },
                                    { property: 'id', value: rec.get('versionOhopId') }
                                ];
                                localStorage.setItem(""BasicCharacteristicOPVersionsListFilter"", JSON.stringify(settings));
                                var link = """);
#nullable restore
#line 786 "D:\-urfu\its\Urfu.Its.Web\Urfu.Its.Web\Views\ModuleAnnotations\Index.cshtml"
                                       Write(Url.Action("Versions","BasicCharacteristicOP"));

#line default
#line hidden
#nullable disable
                WriteLiteral(@""";
                                window.open(link, '_blank');
                            }
                        }
                    ]
                }
            ]
        });

        var items = [
            gridPanel
        ];

        Urfu.createViewport('border', items);
    });
    </script>
");
            }
            );
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
