Шаблонный движок использует разметку вида: <<{команда}>>.
На вход процессора шаблонов подается docx-документ и clr-объект, являющийся моделью шаблона. 
Движок поддерживает контексты вычисления данных. Корневой контекст - сама модель шаблона.

*Далее для обозначения C# выражения будет использоваться значение expr, а для именования произвольных переменных - varName.
*Для обозначения опциональных частей команд будут использоваться фигурные скобки {опциональная часть}.

Поддерживаются следующие команды:
1) [expr] - подстановка вычесленного выражения
2) foreach {varName in} expr - итерация по IEnumerable расчитываемой выражением expr. Итерация приводит к изменению контекста на итерируемый элемент. Чтобы избежать изменения контекста можно указать переменную, в которую будет помещен итерируемый элемент.
Команда должна иметь закрывающийся "тэг" /foreach.
Открывающая команда, контент между, закрывающая команда - все они должны располагаться в отдельных параграфах.
3) if expr - вставляет контент между открывающим и закрывающим тегами, если expr вычисляется как истина.
Открывающая команда, контент между, закрывающая команда - все они должны располагаться в отдельных параграфах.
4) image expr1; {expr2; expr3{; expr4}} - вставка изображения в документ.
Параметры:
expr1 - экземпляр типа System.Drawing.Image.
expr2 - ширина шейпа
expr3 - высота шейпа
expr4 - режим вставки. Доступные режимы:
	"minorfitpreserve" - изображение растягивается на минимальный размер между разрешением и указанным значением по ширине/высоте с сохранением пропорций
	любое значение или null - растягивание изображения на указанную ширину и высоту	
5) rows {varName in} expr - итерация по IEnumerable расчитываемой выражением expr и вставка строк в таблицу для каждого элемента. Итерация приводит к изменению контекста на итерируемый элемент. Чтобы избежать изменения контекста можно указать переменную, в которую будет помещен итерируемый элемент.
Команда должна иметь закрывающийся "тэг" /rows.
6) with expr - изменение контекста данных на результат вычисления expr

В выражениях могут использоваться все публичные свойства и методы контекста. Также доступны пополнительные переменные: 
1) _parent - родительский контекст. Может быть null.
2) _data - текущий контекст
3) _index - индекс итерируемого элемента
4) _number - номер итерируемого элемента (_index + 1)